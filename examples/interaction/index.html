<html>
    <head>
        <script src="../../dist/fae.js"></script>
    </head>
    <body>
        <canvas id="view" width="512" height="512"></canvas>

        <script>
            const view = document.getElementById('view');
            const renderer = new Fae.render.Renderer(view);
            const interaction = new Fae.interaction.InteractionSystem(view);

            renderer.addSystem(new Fae.sprite.SpriteRenderSystem(renderer));
            renderer.addSystem(interaction);

            class Card extends Fae.sprite.Sprite.with(Fae.interaction.InteractionComponent) {
                _updateBounds()
                {
                    this._bounds.clear();

                    if (!this.visible) return;

                    this._bounds.addQuad(this.vertexData);
                }
            }

            const img = new Image();
            let sprite = null;

            img.src = '../basic/spade_A.png';
            img.addEventListener('load', function ()
            {
                setup();
                render();
            });

            interaction.onHoverStart.add(function (obj, pointer) {
                obj.transform.scaleX *= 1.5;
                obj.transform.scaleY *= 1.5;
                obj.transform.update();
            });

            interaction.onHoverEnd.add(function (obj, pointer) {
                obj.transform.scaleX /= 1.5;
                obj.transform.scaleY /= 1.5;
                obj.transform.update();
            });

            interaction.onDown.add(flip);
            interaction.onUp.add(flip);
            interaction.onUpOutside.add(flip);

            function flip(obj)
            {
                obj.transform.scaleY *= -1.0;
                obj.transform.update();
            }

            function setup() {
                sprite = new Card(new Fae.textures.Texture(img));
                sprite.anchorX = sprite.anchorY = 0.5;
                sprite.transform.x = view.width / 2;
                sprite.transform.y = view.height / 2;

                sprite.transform.update();

                renderer.addEntity(sprite);
            }

            function render() {
                requestAnimationFrame(render);

                renderer.render();
            }
        </script>
    </body>
</html>
